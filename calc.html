<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
/* ---------- GLOBAL ---------- */
body {
  background: radial-gradient(circle at top, #141414, #0b0b0b);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: "Segoe UI", sans-serif;
  overflow: hidden;
}

/* Subtle CSI watermark */
body::before {
  content: "CSI";
  position: fixed;
  font-size: 18rem;
  font-weight: 800;
  color: rgba(255,255,255,0.015);
  letter-spacing: 1rem;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(-15deg);
  pointer-events: none;
  user-select: none;
}

/* ---------- CALCULATOR ---------- */
.calculator, .notes {
  background: #181818;
  width: 330px;
  border-radius: 14px;
  padding: 15px;
  color: #fff;
  box-shadow: 0 0 30px rgba(0,0,0,0.8);
  position: relative;
}

.display {
  background: linear-gradient(145deg, #000, #111);
  padding: 10px;
  border-radius: 8px;
  min-height: 90px;
  margin-bottom: 12px;
}

.history {
  font-size: 12px;
  max-height: 45px;
  overflow-y: auto;
  opacity: 0.6;
}

.input {
  font-size: 24px;
  text-align: right;
  word-wrap: break-word;
  margin-top: 5px;
}

.buttons {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

button {
  padding: 15px;
  font-size: 18px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: #262626;
  color: white;
  transition: transform 0.1s, box-shadow 0.1s;
}

button:hover {
  transform: translateY(-1px);
  box-shadow: 0 0 8px rgba(255,255,255,0.05);
}

.operator { background: #333; }
.equal { background: linear-gradient(145deg, #ff9500, #ff7a00); }
.clear { background: #b71c1c; }

/* ---------- NOTES VAULT ---------- */
.notes {
  backdrop-filter: blur(12px);
  animation: fadeIn 0.6s ease;
}

.notes h2 {
  text-align: center;
  margin-bottom: 10px;
  letter-spacing: 2px;
  font-weight: 600;
  opacity: 0.9;
}

.notes textarea {
  width: 100%;
  height: 70px;
  background: rgba(0,0,0,0.7);
  color: #fff;
  border: 1px solid rgba(255,255,255,0.08);
  padding: 10px;
  border-radius: 8px;
  resize: none;
  outline: none;
  transition: box-shadow 0.2s;
}

.notes textarea:focus {
  box-shadow: 0 0 12px rgba(255,149,0,0.4);
}

.notes button {
  width: 100%;
  margin-top: 10px;
  background: linear-gradient(145deg, #ff9500, #ff7a00);
}

.note {
  background: rgba(255,255,255,0.05);
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  border-left: 3px solid #ff9500;
  animation: slideUp 0.3s ease;
}

.note div {
  outline: none;
}

.note button {
  background: #444;
  margin-top: 5px;
  font-size: 12px;
}

.hidden { display: none; }

/* ---------- ANIMATIONS ---------- */
@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
</head>

<body>

<!-- CALCULATOR -->
<div class="calculator" id="calculator">
  <div class="display">
    <div class="history" id="history"></div>
    <div class="input" id="input"></div>
  </div>

  <div class="buttons">
    <button onclick="press('7')">7</button>
    <button onclick="press('8')">8</button>
    <button onclick="press('9')">9</button>
    <button class="operator" onclick="press('/')">/</button>

    <button onclick="press('4')">4</button>
    <button onclick="press('5')">5</button>
    <button onclick="press('6')">6</button>
    <button class="operator" onclick="press('*')">*</button>

    <button onclick="press('1')">1</button>
    <button onclick="press('2')">2</button>
    <button onclick="press('3')">3</button>
    <button class="operator" onclick="press('-')">-</button>

    <button onclick="press('0')">0</button>
    <button onclick="del()">DEL</button>
    <button class="clear" onclick="clearAll()">C</button>
    <button class="operator" onclick="press('+')">+</button>

    <button class="equal" style="grid-column: span 4" onclick="calculate()">=</button>
  </div>
</div>

<!-- SECRET NOTES -->
<div class="notes hidden" id="notes">
  <h2>VAULT</h2>
  <textarea id="noteInput" placeholder="Write a secret..."></textarea>
  <button onclick="addNote()">Store Note</button>
  <div id="notesList"></div>
  <button onclick="exitNotes()" style="background:#333;margin-top:12px;">Exit</button>
</div>

<script>
let input = localStorage.getItem("calc_input") || "";
let history = JSON.parse(localStorage.getItem("calc_history") || "[]");
let notes = JSON.parse(localStorage.getItem("secret_notes") || "[]");

const inputEl = document.getElementById("input");
const historyEl = document.getElementById("history");
const calc = document.getElementById("calculator");
const notesScreen = document.getElementById("notes");
const notesList = document.getElementById("notesList");

updateDisplay();
renderHistory();
renderNotes();

function press(val) {
  input += val;
  saveInput();
  updateDisplay();
}

function del() {
  input = input.slice(0, -1);
  saveInput();
  updateDisplay();
}

function clearAll() {
  input = "";
  saveInput();
  updateDisplay();
}

function calculate() {
  if (input === "69/67") {
    openNotes();
    return;
  }

  try {
    const result = eval(input);
    history.unshift(`${input} = ${result}`);
    history = history.slice(0, 10);
    localStorage.setItem("calc_history", JSON.stringify(history));
    input = result.toString();
  } catch {
    input = "Error";
  }

  saveInput();
  updateDisplay();
  renderHistory();
}

function updateDisplay() {
  inputEl.textContent = input;
}

function renderHistory() {
  historyEl.innerHTML = history.map(h => `<div>${h}</div>`).join("");
}

function saveInput() {
  localStorage.setItem("calc_input", input);
}

/* NOTES */

function openNotes() {
  calc.classList.add("hidden");
  notesScreen.classList.remove("hidden");
}

function exitNotes() {
  calc.classList.remove("hidden");
  notesScreen.classList.add("hidden");
}

function addNote() {
  const text = document.getElementById("noteInput").value.trim();
  if (!text) return;
  notes.push(text);
  localStorage.setItem("secret_notes", JSON.stringify(notes));
  document.getElementById("noteInput").value = "";
  renderNotes();
}

function renderNotes() {
  notesList.innerHTML = "";
  notes.forEach((note, i) => {
    const div = document.createElement("div");
    div.className = "note";
    div.innerHTML = `
      <div contenteditable="true" onblur="editNote(${i}, this.textContent)">${note}</div>
      <button onclick="deleteNote(${i})">Delete</button>
    `;
    notesList.appendChild(div);
  });
}

function editNote(i, text) {
  notes[i] = text;
  localStorage.setItem("secret_notes", JSON.stringify(notes));
}

function deleteNote(i) {
  notes.splice(i, 1);
  localStorage.setItem("secret_notes", JSON.stringify(notes));
  renderNotes();
}
</script>

</body>
</html>
